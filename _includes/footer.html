<footer style="margin-top: 100px; padding: 40px 0; border-top: 1px dashed var(--glass-border); text-align: center;">
    <p style="margin-bottom: 15px; font-weight: 500; color: var(--text-main); font-size: 0.95em; text-align: center;">
        &copy; {{ site.time | date: '%Y' }} SilverAsh. Built with <i class="fab fa-github"></i> Actions & Jekyll.
    </p>
    
    <div id="stats-area" class="visitor-stats" style="font-size: 0.85em; color: var(--text-muted); display: none; justify-content: center; gap: 15px; align-items: center; opacity: 0.8;">
        <span id="visitor-count-container">
            <i class="fas fa-eye" style="color: var(--primary-color); margin-right: 4px;"></i> 
            总访问量: <span id="visitor-count" style="font-weight: 600; color: var(--primary-color);">...</span>
        </span>
    </div>

    <script>
        (function() {
            async function getVisitorCount() {
                const visitorElement = document.getElementById('visitor-count');
                const statsArea = document.getElementById('stats-area');
                
                // 检查 sessionStorage 标记
                const hasVisited = sessionStorage.getItem('v_session_flag');
                let workerUrl = 'https://api.silverash.site';
                
                // 如果当前会话已访问过，则不增加计数
                if (hasVisited) {
                    workerUrl += '?update=false';
                }

                try {
                    const response = await fetch(workerUrl);
                    if (response.ok) {
                        const text = await response.text();
                        if (text && !isNaN(text.trim())) {
                            visitorElement.innerText = parseInt(text.trim()).toLocaleString();
                            statsArea.style.display = 'flex';
                            
                            // 第一次成功访问后，设置 sessionStorage 标记
                            if (!hasVisited) {
                                sessionStorage.setItem('v_session_flag', 'true');
                            }
                        }
                    }
                } catch (e) {}
            }
            
            if (document.readyState === 'complete') {
                getVisitorCount();
            } else {
                window.addEventListener('load', getVisitorCount);
            }
        })();
    </script>
</footer>
