<script>
    function updateClock() {
        const now = new Date();
        const timeEl = document.getElementById('clock-time');
        const dateEl = document.getElementById('clock-date');
        const lunarEl = document.getElementById('clock-lunar');
        if(timeEl) timeEl.textContent = now.toLocaleTimeString('zh-CN', { hour12: false });
        if(dateEl) dateEl.textContent = now.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' });
        try {
            if(lunarEl) {
                const lunar = new Intl.DateTimeFormat('zh-u-ca-chinese', {day:'numeric', month:'long'}).format(now);
                lunarEl.textContent = "å†œåŽ† " + lunar;
            }
        } catch(e) {}
    }
    setInterval(updateClock, 1000); updateClock();

        function loadHistory() {
            const container = document.getElementById('history-content');
            if (container && window.siteData && window.siteData.history) {
                container.innerHTML = window.siteData.history.map(item => 
                    `<div class="history-item"><span class="history-year" style="color: var(--primary-color); font-weight: bold;">${item.year}</span><br>${item.event}</div>`
                ).join('');
            }
        }
    
        function loadAnimeExtras() {
            const cvName = document.getElementById('cv-name');
            if (cvName && window.siteData && window.siteData.cv_recommend) {
                const cv = window.siteData.cv_recommend;
                cvName.textContent = cv.name;
                document.getElementById('cv-agency').textContent = "ðŸ¢ " + cv.agency;
                document.getElementById('cv-hometown').textContent = "ðŸ“ " + cv.hometown;
                document.getElementById('cv-works').textContent = "ä»£è¡¨ä½œ: " + cv.works;
                document.getElementById('cv-intro').textContent = cv.intro;
                const wikiLink = document.getElementById('cv-wiki-link');
                if (wikiLink) { wikiLink.href = "https://zh.moegirl.org.cn/" + encodeURIComponent(cv.name); }
            }
        }
    
        window.addEventListener('DOMContentLoaded', () => {
            loadHistory();
            loadAnimeExtras();
            if (typeof loadBangumiWiki === 'function') loadBangumiWiki();
        });
</script>
